const translations = {
    'en': {
        'pageTitle': 'KiddoCode - Learning Programming Language',
        'navHome': 'Home',
        'navAboutUs': 'About Us',
        'navOverview': 'Overview',
        'navFeatures': 'Features',
        'navCourses': 'Courses',
        'pythonCourse': 'Python Programming Language',
        'htmlCssCourse': 'HTML/CSS Programming Language',
        'cSharpCourse': 'C# Programming Language',
        'joinUsBtn': 'Join Us',
        'carouselTitle1': 'The Best Platform Learning For Your Child',
        'carouselText1': 'Tempor erat elitr rebum at clita. Diam dolor diam ipsum sit. Aliqu diam amet diam et eos. Clita erat ipsum et lorem et sit, sed stet lorem sit clita duo justo magna dolore erat amet',
        'ourCoursesBtn': 'Our Courses',
        'carouselTitle2': 'Make A Brighter Future For Your Child',
        'carouselText2': 'Let’s build the future, one line of code at a time!',
        'featuresTitle': 'KiddoCode Features',
        'featuresDesc': 'Explore smart, fun, and interactive features designed to make coding exciting for kids! From learning popular programming languages and taking fun quizzes to testing code instantly with our online compiler — and even chatting with a friendly AI tutor — KiddoCode has everything young learners need to become confident coders.',
        'progLangFeatureTitle': 'Programming Languages',
        'progLangFeatureDesc': 'Learn how to code cool games and apps',
        'quizFeatureTitle': 'Quiz',
        'quizFeatureDesc': 'Take fun quizzes to show off your brainpower',
        'testCodeFeatureTitle': 'Test Your Code',
        'testCodeFeatureDesc': 'Test your code with our magic online compiler',
        'askQuestionsFeatureTitle': 'Ask Questions',
        'askQuestionsFeatureDesc': 'Got questions? Ask our friendly chatbot — it never gets tired!',
        'ourCoursesTitle': 'Popular Courses',
        'ourCoursesDesc': 'Explore our wide range of courses and choose what suits you most',
        'exploreCourseBtn': 'Explore Courses',
        'ourTeachersTitle': 'Our Experienced Teachers',
        'ourTeachersDesc': 'Our teachers are passionate educators dedicated to making learning programming fun and accessible for kids of all ages and skill levels.',
        'testimonialTitle': 'What Parents Say!',
        'testimonialDesc': 'Discover why parents love KiddoCode – read their testimonials about how we make learning programming fun and impactful for their children.',
        'contactUsTitle': 'Contact Us',
        'contactUsDesc': 'Get in touch with us for any inquiries or support. Our team is here to help you!',
        'contactUsAddress': '123 Street, New York, USA',
        'contactUsPhone': '+012 345 67890',
        'contactUsEmail': 'info@example.com',
        'quickLinksTitle': 'Quick Links',
        'quickLinksAboutUs': 'About Us',
        'quickLinksContactUs': 'Contact Us',
        'quickLinksPrivacyPolicy': 'Privacy Policy',
        'quickLinksTermsCondition': 'Terms & Condition',
        'quickLinksCareer': 'Career',
        'newsletterTitle': 'Newsletter',
        'newsletterDesc': 'Stay updated with our latest news and offers. Subscribe to our newsletter!',
        'emailPlaceholder': 'Your Email',
        'signUpBtn': 'Sign Up',
        'copyrightText': '© Your Site Name, All Right Reserved.',
        'homeFooterLink': 'Home',
        'cookiesFooterLink': 'Cookies',
        'helpFooterLink': 'Help',
        'faqsFooterLink': 'FQAs',
        // Join Us Page Specific Translations
        'joinUsPageTitle': 'Join Us',
        'signInHeading': 'Sign in',
        'orUseYourAccount': 'or use your account', // Corrected key to match joinUs.html
        'namePlaceholder': 'Name', // Added for joinUs.html
        'passwordPlaceholder': 'Password',
        'forgotPassword': 'Forgot your password?',
        'signInButton': 'Sign In',
        'signUpButton': 'Sign Up', // Added for joinUs.html
        'welcomeBackHeading': 'Welcome Back!',
        'welcomeBackText': 'To keep connected with us please login with your personal info',
        'signInButtonGhost': 'Sign In',
        'helloFriendHeading': 'Hello, Friend!',
        'helloFriendText': 'Enter your personal details and start journey with us',
        'signUpButtonGhost': 'Sign Up',
        'createAccountHeading': 'Create Account',
        'useEmailForRegistration': 'or use your email for registration',
        // Dashboard Page Specific Translations
        'dashboardPageTitle': "Kids' Learning Adventure",
        'logoutButton': 'Log Out',
        'logoutText': 'Log Out',
        'brightTheme': 'Bright',
        'cozyTheme': 'Cozy',
        'welcomeHeading': 'Welcome, Little Explorer!',
        'quizzesCardTitle': 'Fun Quizzes!',
        'quizzesCardDesc': 'Test your knowledge with exciting quizzes.',
        'quizzesCountTextSingular': 'Quiz',
        'quizzesCountTextPlural': 'Quizzes',
        'lessonsCardTitle': 'Storytime & Lessons!',
        'lessonsCardDesc': 'Explore wonderful stories and new lessons.',
        'lessonsCountTextSingular': 'Story',
        'lessonsCountTextPlural': 'Stories',
        'friendsCardTitle': 'My Friends',
        'friendsCardDesc': 'See your friends\' progress and achievements.',
        'achievementsCardTitle': 'My Achievements',
        'achievementsCardDesc': 'Unlock new badges and celebrate your learning!',
        'achievementsCountTextSingular': 'Badge',
        'achievementsCountTextPlural': 'Badges',
        // Exam Admin Page Specific Translations
        'examManagementTitle': 'Exam Management System',
        'yourExams': '📚 Your Exams',
        'tableHeaderTitle': 'Title',
        'tableHeaderQuestions': 'Questions',
        'tableHeaderActions': 'Actions',
        'createNewExamButton': '➕ Create New Exam',
        'createExamFormTitle': '✨ Create New Exam ✨',
        'editExamFormTitle': '✏️ Edit Exam ✏️',
        'examTitleLabel': 'Exam Title:',
        'enterExamTitlePlaceholder': 'Enter exam title',
        'addQuestionButton': '+ Add Question',
        'saveExamButton': '💾 Save Exam',
        'backToExamsListButton': '← Back to Exams List',
        'editButton': '✏️ Edit',
        'deleteButton': '🗑️ Delete',
        'viewButton': '👁️ View',
        'questionLabel': 'Question:',
        'enterQuestionTextPlaceholder': 'Enter question text',
        'optionALabel': 'Option A:',
        'optionBLabel': 'Option B:',
        'optionCLabel': 'Option C:',
        'optionDLabel': 'Option D:',
        'correctAnswerLabel': 'Correct Answer (A/B/C/D):',
        'correctOptionPlaceholder': 'Correct option',
        'removeQuestionButton': '🗑️ Remove Question',
        'alertEnterExamTitle': 'Please enter an exam title.',
        'alertAddAtLeastOneQuestion': 'Please add at least one question.',
        'alertFillAllFieldsCorrectly': 'Please fill all fields correctly for each question.\nCorrect answer must be A, B, C, or D.',
        'confirmDeleteExam': 'Are you sure you want to delete this exam?\nThis action cannot be undone.',
        'questionSingular': 'question',
        'questionPlural': 'questions',
        'modalQuestionPrefix': 'Question',
        'modalCloseButton': '✕',
        // Overview Section Translations
        'overviewTitle': 'Learn More About Our Work And Our Cultural Activities',
        'overviewPara1': 'KiddoCode is an interactive web platform specially designed to teach programming to children aged 8–15 in a fun, simple, and engaging way.',
        'overviewPara2': 'Through colorful lessons, hands-on coding with an online compiler, exciting challenges, and a friendly AI chatbot assistant, kids can explore the world of programming easily and at their own pace.',
        'overviewPara3': 'KiddoCode makes learning to code feel like a game — motivating young minds to unlock their creativity, logical thinking, and problem-solving skills, all for free!',
        // Courses Section
        'coursesSectionTitle': 'Our Programming Language Courses',
        'coursesSectionDesc': 'Explore our hands-on programming courses designed for all levels. Learn popular languages like Python, Visual Basic, HTML/CSS, and JavaScript through practical projects, expert instruction, and real-world examples. Whether you\'re a beginner or looking to advance your skills, we\'ve got you covered.',
        'pythonLanguageCourse': 'Python Language',
        'lessonsCount': 'Lessons',
        'projectsCount': 'Projects',
        'videosCount': 'Videos'
    },
    'ar': {
        'pageTitle': 'كيدو كود - تعلم لغات البرمجة',
        'navHome': 'الرئيسية',
        'navAboutUs': 'من نحن',
        'navOverview': 'نظرة عامة',
        'navFeatures': 'الميزات',
        'navCourses': 'الدورات',
        'pythonCourse': 'لغة بايثون للبرمجة',
        'htmlCssCourse': 'لغة HTML/CSS للبرمجة',
        'cSharpCourse': 'لغة #C للبرمجة',
        'joinUsBtn': 'انضم إلينا',
        'carouselTitle1': 'أفضل منصة تعليمية لطفلك',
        'carouselText1': 'لقد كانت المدة جيدة، ولكن في كلتا الحالتين. جلوس الألم الماس. أليكو الماس ديام وفقط وأيضا. كانت كليتا إرات إيبسوم ولوريم وست، جلست لوريم في كلتا الحالتين تماماً ألم كبير.',
        'ourCoursesBtn': 'دوراتنا',
        'carouselTitle2': 'اصنع مستقبلاً أكثر إشراقاً لطفلك',
        'carouselText2': 'هيا نبني المستقبل، سطرًا برمجيًا تلو الآخر!',
        'featuresTitle': 'ميزات كيدو كود',
        'featuresDesc': 'استكشف ميزاتنا الذكية والممتعة والتفاعلية المصممة لجعل البرمجة مثيرة للأطفال! من تعلم لغات البرمجة الشائعة وإجراء اختبارات ممتعة لاختبار الكود على الفور باستخدام مترجمنا عبر الإنترنت - وحتى الدردشة مع مدرس الذكاء الاصطناعي الودود - لدى كيدو كود كل ما يحتاجه المتعلمون الصغار ليصبحوا مبرمجين واثقين.',
        'progLangFeatureTitle': 'لغات البرمجة',
        'progLangFeatureDesc': 'تعلم كيفية برمجة الألعاب والتطبيقات الرائعة',
        'quizFeatureTitle': 'اختبارات',
        'quizFeatureDesc': 'شارك في اختبارات ممتعة لإظهار قدراتك الذهنية',
        'testCodeFeatureTitle': 'اختبر كودك',
        'testCodeFeatureDesc': 'اختبر كودك باستخدام مترجمنا السحري عبر الإنترنت',
        'askQuestionsFeatureTitle': 'اطرح الأسئلة',
        'askQuestionsFeatureDesc': 'هل لديك أسئلة؟ اسأل روبوت الدردشة الودود الخاص بنا — إنه لا يتعب أبدًا!',
        'ourCoursesTitle': 'الدورات الشائعة',
        'ourCoursesDesc': 'استكشف مجموعتنا الواسعة من الدورات واختر ما يناسبك',
        'exploreCourseBtn': 'استكشف الدورات',
        'ourTeachersTitle': 'معلمونا ذوو الخبرة',
        'ourTeachersDesc': 'معلمونا هم تربويون متحمسون مكرسون لجعل تعلم البرمجة ممتعًا ومتاحًا للأطفال من جميع الأعمار ومستويات المهارة.',
        'testimonialTitle': 'ماذا يقول الآباء!',
        'testimonialDesc': 'اكتشف لماذا يحب الآباء KiddoCode - اقرأ شهاداتهم حول كيف نجعل تعلم البرمجة ممتعًا ومؤثرًا لأطفالهم.',
        'contactUsTitle': 'اتصل بنا',
        'contactUsDesc': 'تواصل معنا لأي استفسارات أو دعم. فريقنا هنا لمساعدتك!',
        'contactUsAddress': '123 شارع، نيويورك، الولايات المتحدة الأمريكية',
        'contactUsPhone': '+012 345 67890',
        'contactUsEmail': 'info@example.com',
        'quickLinksTitle': 'روابط سريعة',
        'quickLinksAboutUs': 'من نحن',
        'quickLinksContactUs': 'اتصل بنا',
        'quickLinksPrivacyPolicy': 'سياسة الخصوصية',
        'quickLinksTermsCondition': 'الشروط والأحكام',
        'quickLinksCareer': 'الوظائف',
        'newsletterTitle': 'النشرة الإخبارية',
        'newsletterDesc': 'ابقَ على اطلاع بآخر أخبارنا وعروضنا. اشترك في نشرتنا الإخبارية!',
        'emailPlaceholder': 'بريدك الإلكتروني',
        'signUpBtn': 'اشتراك',
        'copyrightText': '© اسم موقعك، جميع الحقوق محفوظة.',
        'homeFooterLink': 'الرئيسية',
        'cookiesFooterLink': 'ملفات تعريف الارتباط',
        'helpFooterLink': 'المساعدة',
        'faqsFooterLink': 'الأسئلة الشائعة',
        // Join Us Page Specific Translations
        'joinUsPageTitle': 'انضم إلينا',
        'signInHeading': 'تسجيل الدخول',
        'orUseYourAccount': 'أو استخدم حسابك', // Corrected key to match joinUs.html
        'namePlaceholder': 'الاسم', // Added for joinUs.html
        'passwordPlaceholder': 'كلمة المرور',
        'forgotPassword': 'هل نسيت كلمة المرور؟',
        'signInButton': 'تسجيل الدخول',
        'signUpButton': 'انشاء حساب', // Added for joinUs.html
        'welcomeBackHeading': 'أهلاً بك مجدداً!',
        'welcomeBackText': 'للبقاء على اتصال معنا، يرجى تسجيل الدخول بمعلوماتك الشخصية',
        'signInButtonGhost': 'تسجيل الدخول',
        'helloFriendHeading': 'مرحباً يا صديق!',
        'helloFriendText': 'أدخل تفاصيلك الشخصية وابدأ رحلتك معنا',
        'signUpButtonGhost': 'انشاء حساب',
        'createAccountHeading': 'انشاء حساب',
        'useEmailForRegistration': 'أو استخدم بريدك الإلكتروني للتسجيل',
        // Dashboard Page Specific Translations
        'dashboardPageTitle': 'مغامرة تعلم الأطفال',
        'logoutButton': 'تسجيل الخروج',
        'logoutText': 'تسجيل الخروج',
        'brightTheme': 'ساطع',
        'cozyTheme': 'مريح',
        'welcomeHeading': 'أهلاً بك أيها المستكشف الصغير!',
        'quizzesCardTitle': 'اختبارات ممتعة!',
        'quizzesCardDesc': 'اختبر معلوماتك باختبارات شيقة.',
        'quizzesCountTextSingular': 'اختبار',
        'quizzesCountTextPlural': 'اختبارات',
        'lessonsCardTitle': 'وقت القصة والدروس!',
        'lessonsCardDesc': 'استكشف قصص رائعة ودروساً جديدة.',
        'lessonsCountTextSingular': 'قصة',
        'lessonsCountTextPlural': 'قصص',
        'friendsCardTitle': 'أصدقائي',
        'friendsCardDesc': 'شاهد تقدم أصدقائك وإنجازاتهم.',
        'achievementsCardTitle': 'إنجازاتي',
        'achievementsCardDesc': 'افتح شارات جديدة واحتفل بتعلمك!',
        'achievementsCountTextSingular': 'شارة',
        'achievementsCountTextPlural': 'شارات',
        // Exam Admin Page Specific Translations
        'examManagementTitle': 'نظام إدارة الامتحانات',
        'yourExams': '📚 امتحاناتك',
        'tableHeaderTitle': 'العنوان',
        'tableHeaderQuestions': 'الأسئلة',
        'tableHeaderActions': 'الإجراءات',
        'createNewExamButton': '➕ إنشاء امتحان جديد',
        'createExamFormTitle': '✨ إنشاء امتحان جديد ✨',
        'editExamFormTitle': '✏️ تعديل الامتحان ✏️',
        'examTitleLabel': 'عنوان الامتحان:',
        'enterExamTitlePlaceholder': 'أدخل عنوان الامتحان',
        'addQuestionButton': '+ إضافة سؤال',
        'saveExamButton': '💾 حفظ الامتحان',
        'backToExamsListButton': '← العودة إلى قائمة الامتحانات',
        'editButton': '✏️ تعديل',
        'deleteButton': '🗑️ حذف',
        'viewButton': '👁️ عرض',
        'questionLabel': 'السؤال:',
        'enterQuestionTextPlaceholder': 'أدخل نص السؤال',
        'optionALabel': 'الخيار أ:',
        'optionBLabel': 'الخيار ب:',
        'optionCLabel': 'الخيار ج:',
        'optionDLabel': 'الخيار د:',
        'correctAnswerLabel': 'الإجابة الصحيحة (أ/ب/ج/د):',
        'correctOptionPlaceholder': 'الخيار الصحيح',
        'removeQuestionButton': '🗑️ إزالة السؤال',
        'alertEnterExamTitle': 'الرجاء إدخال عنوان للامتحان.',
        'alertAddAtLeastOneQuestion': 'الرجاء إضافة سؤال واحد على الأقل.',
        'alertFillAllFieldsCorrectly': 'الرجاء ملء جميع الحقول بشكل صحيح لكل سؤال.\nيجب أن تكون الإجابة الصحيحة A أو B أو C أو D.',
        'confirmDeleteExam': 'هل أنت متأكد أنك تريد حذف هذا الامتحان؟\nلا يمكن التراجع عن هذا الإجراء.',
        'questionSingular': 'سؤال',
        'questionPlural': 'أسئلة',
        'modalQuestionPrefix': 'سؤال',
        'modalCloseButton': '✕',
        // Overview Section Translations
        'overviewTitle': 'تعرف على المزيد عن عملنا وأنشطتنا الثقافية',
        'overviewPara1': 'كيدو كود هي منصة ويب تفاعلية مصممة خصيصًا لتعليم البرمجة للأطفال الذين تتراوح أعمارهم بين 8 و15 عامًا بطريقة ممتعة وبسيطة وجذابة.',
        'overviewPara2': 'من خلال الدروس الملونة والبرمجة العملية باستخدام مترجم عبر الإنترنت وتحديات مثيرة ومساعد دردشة آلي ودي، يمكن للأطفال استكشاف عالم البرمجة بسهولة وبسرعتهم الخاصة.',
        'overviewPara3': 'كيدو كود يجعل تعلم البرمجة يبدو وكأنه لعبة — مما يحفز العقول الشابة على إطلاق إبداعهم وتفكيرهم المنطقي ومهارات حل المشكلات، كل ذلك مجانًا!',
        // Courses Section
        'coursesSectionTitle': 'دوراتنا في لغات البرمجة',
        'coursesSectionDesc': 'استكشف دوراتنا العملية في البرمجة المصممة لجميع المستويات. تعلم لغات شائعة مثل بايثون، فيجوال بيسك، HTML/CSS، وجافاسكريبت من خلال مشاريع عملية، وتعليمات الخبراء، وأمثلة من العالم الحقيقي. سواء كنت مبتدئًا أو تسعى لتطوير مهاراتك، فنحن نوفر لك كل ما تحتاجه.',
        'pythonLanguageCourse': 'لغة بايثون',
        'lessonsCount': 'الدروس',
        'projectsCount': 'المشاريع',
        'videosCount': 'مقاطع الفيديو'
    }
};

function applyLanguage(lang) {
    document.querySelectorAll('[data-lang-key]').forEach(element => {
        const key = element.getAttribute('data-lang-key');
        if (translations[lang] && translations[lang][key]) {
            // Special handling for placeholder attributes
            if (element.placeholder) {
                element.placeholder = translations[lang][key];
            } else {
                element.textContent = translations[lang][key];
            }
        }
    });

    // Handle directionality for Arabic
    if (lang === 'ar') {
        document.documentElement.setAttribute('dir', 'rtl');
        document.body.classList.add('arabic-font');
    } else {
        document.documentElement.setAttribute('dir', 'ltr');
        document.body.classList.remove('arabic-font');
    }

    // If initializeCarousels function exists (from main.js), re-initialize them
    if (typeof window.initializeCarousels === 'function') {
        // Destroy existing carousels before re-initialization if they exist
        // This check is important as jQuery might not be available or Owl Carousel not initialized yet
        if (typeof $ !== 'undefined' && $.fn.owlCarousel) {
            if ($(".header-carousel").hasClass("owl-carousel")) {
                $(".header-carousel").owlCarousel('destroy');
            }
            if ($(".testimonial-carousel").hasClass("owl-carousel")) {
                $(".testimonial-carousel").owlCarousel('destroy');
            }
        }
        window.initializeCarousels();
    }
}

document.addEventListener('DOMContentLoaded', () => {
    const langSwitcher = document.getElementById('select-language');

    // Load saved language or default to English
    const savedLang = localStorage.getItem('selectedLanguage') || 'en';
    if (langSwitcher) {
        langSwitcher.value = savedLang;
        langSwitcher.addEventListener('change', (event) => {
            const newLang = event.target.value;
            localStorage.setItem('selectedLanguage', newLang);
            applyLanguage(newLang);
            // Re-run any page-specific data loading functions that need re-translation
            if (typeof loadExams === 'function') { // Check if loadExams is defined (for examAdmin.html)
                loadExams(); // Reload exams to apply new table header labels and messages
            }
            // For Dashboard counts, these functions are called in Dashboard's DOMContentLoaded
            // and also listen to 'storage' events. So, they should update automatically.
        });
    }

    // Apply language on initial load of the page
    applyLanguage(savedLang);

    // This ensures that if the 'select-language' dropdown is not on the current page
    // (e.g., on examAdmin.html directly), the language is still applied based on localStorage.
    if (!langSwitcher) {
        applyLanguage(savedLang);
    }
});